async function start(imageElements){console.log("开始准备数据 (Start to prepare the data).");var zip=new JSZip;for(const imageElement of imageElements){let url=imageElement.src==undefined?imageElement.href:imageElement.src;if(url==undefined)continue;let extName=url.substring(url.lastIndexOf(".")+1);let blob=await getBlob(url,extName);zip.file((new Date).getTime()+"."+extName,blob,{base64:false});console.log("Successfully fetch one of the image,total is "+imageElements.length)}download(zip)}function getBlob(url,type){return new Promise((ret,res)=>{let img=new Image;img.crossOrigin="anonymous";img.src=url;img.onload=function(){let _canvas=document.createElement("canvas");_canvas.width=this.width;_canvas.height=this.height;_canvas.getContext("2d").drawImage(this,0,0,this.width,this.height);_canvas.toBlob(function(blob){ret(blob)},`image/${type}`,.92)}})}function download(zip){zip.generateAsync({type:"blob"}).then(function(content){console.log("开始下载 (Start the download).");var eleLink=document.createElement("a");eleLink.download=(new Date).getTime()+".zip";eleLink.style.display="none";eleLink.href=URL.createObjectURL(content);document.body.appendChild(eleLink);eleLink.click();document.body.removeChild(eleLink)})}